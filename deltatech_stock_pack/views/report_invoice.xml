<?xml version="1.0" encoding="utf-8"?>
<openerp>
	<data>
		<report string="Package list" id="action_report_package" model="account.invoice" report_type="qweb-pdf" name="deltatech_stock_pack.report_package"
			file="deltatech_stock_pack.report_package" />


		<template id="report_package">
			<t t-call="report.html_container">
				<t t-foreach="doc_ids" t-as="doc_id">
					<t t-raw="translate_doc(doc_id, doc_model, 'partner_id.lang', 'deltatech_stock_pack.report_package_document')" />
				</t>
			</t>
		</template>

		<template id="report_package_document">
			<t t-call="report.html_container">
				<t t-foreach="docs" t-as="o">
					<t t-call="report.external_layout">
						<div class="page">
							<h2 style="text-align:center;">
                                    <span>D.D.T. n. </span>
                                    <span t-field="o.nr_packing_list"/>
                            </h2>
							<h2 style="text-align:center;">
								<span>Package list for invoice</span>
								:
								<span t-field="o.number1"/>
							</h2>
							<t t-set="total_weight" t-value="0"/>
			                <t t-foreach="o.picking_ids" t-as="picking">
		                    	<t t-foreach="picking.pack_operation_ids" t-as="pack_operation">
		                        	<t t-set="total_weight" t-value="total_weight + pack_operation.result_package_id.weight"/>
		                        </t>
				            </t>
							<br />
							<br />
							<table class="table table-condensed">
								<thead>
									<tr>
										<th>
											<strong>NR SCAT</strong>
										</th>
										<th>
											<strong>Product</strong>
										</th>
										<th class="text-right">
											<strong>Quantity</strong>
										</th>
										<th class="text-right">
											<strong>Gross Weight</strong>
										</th>

									</tr>
								</thead>
								<t t-set="nr_crt" t-value="1"/>
								<tbody>
									<tr t-foreach="o.package_ids" t-as="package">
										<td>
											<t t-esc="nr_crt"/>
											<t t-set="nr_crt" t-value="nr_crt + 1"/>
										</td>
										<td>
											<t t-foreach="package.quant_ids" t-as="quant">
												<span t-field="quant.product_id" /><br />
											</t>
										</td>
										<td>
											<t t-foreach="package.quant_ids" t-as="quant">
												<span t-field="quant.qty" /><br />
											</t>
										</td>
										<td class="text-right">
											<span t-field="package.weight" />
										</td>
									</tr>
								</tbody>
							</table>
							<div>
								<span style="font-weight:bold;">PESO NETTO = </span>
								<span style="font-weight:bold;"><t t-esc="total_weight"/></span>
								<span style="font-weight:bold;">KG / PESO LORDO = </span>
								<span style="font-weight:bold;"><span t-field="o.weight" /></span>
								<span style="font-weight:bold;"> KG</span>
							</div>
							<table style="width:100%">
								<tbody>
									<tr>
										<td width="50%">
											<span>DATE:</span>
											<span t-field="o.date_invoice"/> 
										</td>
										<td width="50%">
											<span>STAMP</span>
										</td>
									</tr>
								</tbody>
							</table>
						</div>
					</t>
				</t>
			</t>
		</template>


		<report string="Package list Label" id="action_report_package_label"
				model="account.invoice"
				report_type="prn"
				name="deltatech_stock_pack.report_package_label"
			    file="deltatech_stock_pack.report_package_label" />


		<template id="report_package_label">

				<t t-foreach="doc_ids" t-as="doc_id">
					<t t-raw="translate_doc(doc_id, doc_model, 'partner_id.lang', 'deltatech_stock_pack.report_package_label_document')" />
				</t>

		</template>

		<template id="report_package_label_document">
			<t t-foreach="docs" t-as="o">
				 <t t-foreach="o.picking_ids" t-as="picking">
					 <t t-set="box_nr" t-value="1"/>
					<t t-foreach="picking.pack_operation_ids" t-as="pack_operation">

<t t-translation="off">
^XA~TA000~JSN^LT0^MNW^MTT^PON^PMN^LH0,0^JMA^PR4,4~SD15^JUS^LRN^CI0^XZ
^XA
^MMT
^PW799
^LL1200
^LS0
^FT233,453^A0R,65,64^FH\^FD126^FS
^FT237,47^A0R,65,64^FH\^FDNumber of box:<t t-esc="box_nr"/>^FS
^FT706,49^A0R,78,48^FH\^FDSupplier Name: <t t-esc="o.company_id.name"/>^FS
^FT608,49^A0R,78,48^FH\^FD<t t-esc="o.commercial_partner_id.name.split(' ')[0]"/> Internal Code (SAP): <t t-esc="pack_operation.product_id.default_code"/>^FS
^FT510,49^A0R,78,48^FH\^FDDescription: <t t-esc="pack_operation.product_id.name"/>^FS
^FT412,49^A0R,78,48^FH\^FDQuantity: <t t-esc="pack_operation.product_qty"/>  pz^FS
^FT314,49^A0R,78,48^FH\^FDNet Weight: 3Kg^FS
^FO148,41^GB82,936,82^FS
^FT164,41^A0R,65,64^FR^FH\^FDORDER NUMBER:<t t-esc="picking.sale_id.client_order_ref"/>^FS
^FO66,41^GB82,936,82^FS
^FT82,41^A0R,65,64^FR^FH\^FDDate of Delivery: <t t-esc="o.date_invoice"/>^FS
^PQ1,0,1,Y^XZ
</t>
						<t t-set="box_nr" t-value="box_nr + 1"/>
					</t>
				 </t>
			</t>

		</template>

	</data>
</openerp>