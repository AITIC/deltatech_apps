<?xml version="1.0" encoding="utf-8"?>
<openerp>
	<data>
		<report string="Invoice price Currency" id="action_report_invoice_1" 
		model="account.invoice" report_type="qweb-pdf" 
		name="deltatech_invoice.report_invoice_1"
			file="deltatech_invoice.report_invoice_1" />

		<report string="Invoice company currency" id="action_report_invoice_2" 
		model="account.invoice" report_type="qweb-pdf"
		 name="deltatech_invoice.report_invoice_2"
			file="deltatech_invoice.report_invoice_2" />



		<template id="report_invoice_1">
			<t t-call="report.html_container">
				<t t-foreach="doc_ids" t-as="doc_id">
					<t t-raw="translate_doc(doc_id, doc_model, 'partner_id.lang', 'deltatech_invoice.report_invoice_document1')" />
				</t>
			</t>
			<t t-if="False">
					<t t-call="deltatech_invoice.report_invoice_document1"/>
			</t>
		</template>

		<template id="report_invoice_2">
			<t t-call="report.html_container">
				<t t-foreach="doc_ids" t-as="doc_id">
					<t t-raw="translate_doc(doc_id, doc_model, 'company_id.partner_id.lang', 'deltatech_invoice.report_invoice_document2')" />
				</t>
			</t>
			<t t-if="False">
					<t t-call="deltatech_invoice.report_invoice_document2"/>
			</t>
		</template>

		<!--  afisare in moneda in care este pretul EUR-->
		<template id="report_invoice_document1">
			<t t-set="currency_id" t-value="o.price_currency_id" />		 
			<!-- <t t-call="account.report_invoice_document" /> -->
       			<div class="page">
       				<!-- Header -->
					<table class="table table-condensed" style="border-top: initial;">
						<tr>
							<td style="width:45%">
								<div>
              						<strong t-if="o.type in ['out_invoice', 'out_refund']">SELLER:</strong>
              					</div>
              					<strong t-field="res_company.partner_id.name"/>
                                <div>
              						<span t-field="res_company.street"/>
              					</div>
              					<div>
                                    <span t-field="res_company.state_id"/>
              						(<span t-field="res_company.state_id.code"/>)
              						<span t-field="res_company.country_id"/>
              					</div>
              					<div t-if="res_company.partner_id.vat">
              						<strong>C.U.I. :</strong>
              						<span t-field="res_company.partner_id.vat"/>
            					</div>
            					<small>
					            	<div t-foreach="res_company.partner_id.bank_ids" t-as="bank">
					                	<div t-if="bank.footer">
					                  		<span t-if="bank.bank_name">
					                    		<strong>Bank:</strong>
					                    		<span t-field="bank.bank_name"/>
					                  		</span>
					                	</div>
					                	<br/>
					                	<div t-if="bank.footer">
					                  		<span t-if="bank.acc_number">
					                    		<strong>Account:</strong>
					                    		<span t-field="bank.acc_number"/>
					                  		</span>
					                	</div>
					           		</div>
					           </small>
							</td>
                            <td style="width:10%;padding-top:-30px;">
                                <img t-if="company.logo" t-att-src="'data:image/png;base64,%s' % company.logo" style="max-height: 120px"/>
                            </td>
							<td style="width:45%;text-align:right;">
								<h4>
					              <span t-if="o.type == 'out_invoice' and (o.state == 'open' or o.state == 'paid')">INVOICE NR. </span>
					              <span t-if="o.type == 'out_invoice' and o.state == 'proforma2'">PRO-FORMA</span>
					              <span t-if="o.type == 'out_invoice' and o.state == 'draft'">INVOICE NR. </span>
					              <span t-if="o.type == 'out_invoice' and o.state == 'cancel'">Cancelled Invoice</span>
					              <span t-if="o.type == 'out_refund'">Refund Invoice</span>
					              <span t-if="o.type == 'in_refund'">Supplier Refund</span>
					              <span t-if="o.type == 'in_invoice'">Supplier Invoice</span>
					              <t t-if="o.number">
					                <span t-field="o.number"/>
					              </t>
					              <t t-if="not o.number">
					                <span t-field="o.internal_number"/>
					              </t>
					              <div>
					                <span>DATE: </span>
					                <span t-field="o.date_invoice"/>
					              </div>
					              <div t-if="o.type == 'out_refund'">
					                <span>Refunding invoice</span>
					                <span t-field="o.origin"/>
					              </div>
					            </h4>
							</td>
						</tr>
					</table>
					<table style="width: 100%">
                        <tr>
                            <td style="border:1px solid black; width: 60%;">
                                <strong>
                                    <span>COUNTRY OF ORIGIN: ROMANIA</span><br />
                                    <span>SELLER'S BANK / COUNTER NR</span><br />
                                    <div t-foreach="res_company.bank_ids" t-as="bank">
                                        <span t-if="bank.acc_number">
                                            <span t-if="bank.currency_id.name == 'EUR' ">
                            					<span t-field="bank.bank_name"/>
                                                <br/>
                                                <span>CONT: </span>
                            					<span t-field="bank.acc_number"/>
                                                <span> / SWIFT:  </span>
                                				<span t-field="bank.bank_bic"/>
                                                <br/>
                          					</span>
                                        </span>
                                    </div>
                                    <span>CURRENCY OF PAYMENT: EURO</span><br />
                                </strong>
                            </td>
                            <td style="border:1px solid black; width: 40%;">
                                <strong>
                                    <span>CONSEGNEE / BUYER: </span>
                                    <div>
    						            <span t-field="o.partner_id"/>
						            </div>
                                    <span t-field="o.partner_id.street" /><br />
                                    <span t-field="o.partner_id.zip" /> <span t-field="o.partner_id.city" /><br />
                                    <span t-field="o.partner_id.country_id" /><br />
                                </strong>
                            </td>
                        </tr>
                    </table>
                    <!-- End header -->
                    
                    <!-- Content -->
                    
                    <t t-set="nr_crt" t-value="1"/>
					<t t-if="not currency_id">
						<t t-set="currency_id" t-value="o.currency_id"/>
					</t>	
					<table class="table table-condensed  table-bordered">
						<thead>
							<tr>
								<th>Ord</th>
								<th>Description</th>
								<th>Quantity</th>
								<th class="text-right">Unit Price</th>
								<th class="text-right" t-if="with_discount(o)" groups="sale.group_discount_per_so_line">Discount (%)</th>
								<th class="text-right">Amount</th>
								<th class="text-right">Taxes</th>
							</tr>
						</thead>
						<tbody class="invoice_tbody">
							<tr t-foreach="o.invoice_line" t-as="l">
								<td>
									<t t-esc="nr_crt"/>
									<t t-set="nr_crt" t-value="nr_crt + 1"/>
								</td>
								<td>
									<span t-field="l.name"/>
								</td>
								<td class="text-right">
									<t t-set="quantity" t-value="l.quantity"/>
									<t t-if="o.type == 'out_refund'">
										<t t-set="quantity" t-value="-1*l.quantity"/> 
									</t>
									<span t-if="quantity" id="quantity" t-esc="formatLang(quantity)"/>								 
									<span t-field="l.uos_id" groups="product.group_uom"/>
								</td>
								<td class="text-right">
									<t t-set="price_unit_without_taxes" t-value="l.price_unit_without_taxes"/>
									<t t-set="price_unit_without_taxes" t-value="o.currency_id.with_context(date=o.date_invoice).compute(price_unit_without_taxes,currency_id)"/>
									<span id="price_unit_without_taxes" t-esc="formatLang(price_unit_without_taxes)"/>	
								</td>
								<td class="text-right" t-if="with_discount(o)" groups="sale.group_discount_per_so_line">
									<span t-field="l.discount"/>
								</td>
								<td class="text-right">
									<t t-set="price_subtotal" t-value="l.price_subtotal"/>
									<t t-if="o.type == 'out_refund'">
										<t t-set="price_subtotal" t-value="-1*l.price_subtotal"/>
									</t>
 									<t t-set="price_subtotal" t-value="o.currency_id.with_context(date=o.date_invoice).compute(price_subtotal,currency_id)"/>
									<span id="price_subtotal" t-esc="formatLang(price_subtotal)"/>	
								</td>
								<td class="text-right">
									<t t-set="price_taxes" t-value="l.price_taxes"/>
									<t t-if="o.type == 'out_refund'">
										<t t-set="price_taxes" t-value="-1*l.price_taxes"/>
										 
									</t>
									<t t-set="price_taxes" t-value="o.currency_id.with_context(date=o.date_invoice).compute(price_taxes,currency_id)"/>
									<span id="price_taxes" t-esc="formatLang(price_taxes)"/>
								</td>
							</tr>
						</tbody>
					</table>
					<div style="page-break-inside: avoid !important;">
						<div class="row">

							<div class="col-xs-8" t-if="o.type == 'out_invoice' or o.type == 'out_refund' ">
								<table class="table table-condensed">

									<tr class="border-black">
										<td>Elaborate:</td>
										<td>Information for delivery:</td>
									</tr>

									<tr class="border-black">
										<td>
											<span>Name:</span>
											<span t-field="o.user_id"/>
										</td>
										<td>
											<div>
												<span>Delegate:</span>
												<span t-field="o.delegate_id"/>
											</div>
											<div>
												<span>Mean Transport:</span>
												<span t-field="o.mean_transp"/>
											</div>
											<div>
												<span>Signature for receive</span>
											</div>
										</td>
									</tr>
								</table>
							</div>

							<div class="col-xs-4 pull-right">
								<table class="table table-condensed">
									<tr class="border-black">
										<td>
											<strong>Total Without Taxes</strong>
										</td>
										<td class="text-right">
											 <t t-set="amount_untaxeds" t-value="o.amount_untaxed"/>
											 <t t-if="o.type == 'out_refund'">
												<t t-set="amount_untaxeds" t-value="-1*o.amount_untaxed"/>
												
											</t>
										    <t t-set="amount_untaxeds" t-value="o.currency_id.with_context(date=o.date_invoice).compute(amount_untaxeds,currency_id)"/> 
 											<span id="amount_untaxeds">
 												<span t-esc="formatLang(amount_untaxeds)"/> <span t-field="currency_id.symbol"/>
 											</span> 
										</td>
									</tr>
									<tr>
										<td>Taxes</td>
										<td class="text-right">
											<t t-set="amount_tax" t-value="o.amount_tax"/> 
											<t t-if="o.type == 'out_refund'">
												<t t-set="amount_tax" t-value="-1*o.amount_tax"/>
											</t>
		 									<t t-set="amount_tax" t-value="o.currency_id.with_context(date=o.date_invoice).compute(amount_tax,currency_id)"/> 		
 											<span id="amount_tax">
 												<span t-esc="formatLang(amount_tax)"/> <span t-field="currency_id.symbol"/>
 											</span>
    
										</td>
									</tr>
									<tr class="border-black">
										<td>
											<strong>Total</strong>
										</td>
										<td class="text-right">
											<t t-set="amount_total" t-value="o.amount_total"/>
											<t t-if="o.type == 'out_refund'">
												<t t-set="amount_total" t-value="-1*o.amount_total"/>
												
											</t>
                                            <t t-set="amount_total" t-value="o.currency_id.with_context(date=o.date_invoice).compute(amount_total,currency_id)"/>
 											<span id="amount_total">
 											 <span t-esc="formatLang(amount_total)"/> <span t-field="currency_id.symbol"/>
 											</span>
 											
	                                        <div t-if="currency_id!=res_company.currency_id">
	                                            (
	                                            <t t-if="o.type == 'out_refund'">
	                                                <t t-set="amount_total" t-value="-1*o.move_id.amount"/>
	                                            </t>  
                                                <t t-set="amount_total" t-value="currency_id.with_context(date=o.date_invoice).compute(amount_total,res_company.currency_id)"/>
	                                            <span id="amount_total_company_currency">
     											    <span t-esc="formatLang(amount_total)"/> <span t-field="res_company.currency_id.symbol"/>
 											    </span>
	                                            )                                                                                    
	                                        </div> 	 											
 											
										</td>
									</tr>
								</table>
							</div>
						</div>



						<p t-if="o.comment">
							<strong>Comment:</strong>
							<span t-field="o.comment"/>
						</p>

						<small t-if="o.type == 'out_invoice' or o.type == 'out_refund'">
							<div>Printing and numbering system of its own under Law 571/2003 on the Fiscal Code, with subsequent amendments and OMPF 2226/2006</div>

							<t t-if="not res_company.stamp_image">
								<div>Invoice circulate without signature and stamp according to the law 571/2003, rule 115, paragraph 6</div>
							</t>
							<img t-if="res_company.stamp_image" t-att-src="'data:image/png;base64,%s' % res_company.stamp_image" style="max-height: 150px; "/>
						</small>

						<div t-if="o.commercial_partner_id.info_for_invoice">
							<span t-field="o.commercial_partner_id.info_for_invoice"/>
						</div>

						<div t-if="o.type == 'out_invoice' and o.payment_ids">
							<br/>
							<br/>
							<div t-foreach="o.payment_ids" t-as="payment" style="border-top: 1px solid black;">

								<t t-if="payment.credit != 0 and payment.journal_id.type == 'cash'">

									<div>
										<strong t-field="res_company.partner_id.name"/>
									</div>
									<div>
										VAT:
										<span t-field="res_company.partner_id.vat"/>
									</div>
									<div>
										NRC:
										<span t-field="res_company.partner_id.nrc"/>
									</div>
									<address t-field="res_company.partner_id" t-field-options="{&quot;widget&quot;: &quot;contact&quot;, &quot;fields&quot;: [&quot;address&quot;], &quot;no_marker&quot;: true, &quot;no_tag_br&quot;: true}"/>
									<h4>
										<span>Voucher:</span>
										<span t-field="payment.ref"/>
										<span>/</span>
										<span t-field="payment.date"/>
									</h4>
									<div>
										<span>I received from</span>
										<strong t-field="o.partner_id.name"/>
										<span t-if="o.partner_id.city">
											from
											<span t-field="o.partner_id.city"/>
											<span t-field="o.partner_id.street"/>
											<span t-field="o.partner_id.street2"/>
										</span>
										,
										<span>amount</span>

										<span t-field="payment.credit" t-field-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: &quot;o.currency_id&quot;}"/>
										(
										<span t-esc="convert(payment.credit)"/>
										)
									</div>
									<div>
										Representing counter value of invoice
										<span t-field="o.number"/>
									</div>

								</t>

							</div>
						</div>

						<p t-if="o.payment_term.note">
							<strong>Payment Term:</strong>
							<span t-field="o.payment_term.note"/>
						</p>
						<p t-if="o.fiscal_position.note">
							<strong>Fiscal Position Remark:</strong>
							<span t-field="o.fiscal_position.note"/>
						</p>
					</div>
                    
                    <!-- End content -->
				</div>
		</template>

	    <!--  afisare in moneda de baza RON -->
		<template id="report_invoice_document2">
			<t t-set="currency_id" t-value="o.company_id.currency_id" />		 
			<!-- <t t-call="account.report_invoice_document" /> -->
		</template>

		<template id="header_invoice2"> 
			<!--  aici se poate dezvolta un alt antet -->
			<xpath expr="//div[@class='header']" position="replace">
				<div class="header">
					<div class="row zero_min_height">
						<div class="col-xs-12">
							<div style="border-bottom: 1px solid black;"/>
						</div>
					</div>

					<table class="table table-condensed" style="border-top: initial;">
	    				<tr>
	        				<td width="35%">
								<h3 t-field="res_company.partner_id.name"/>
                                <span>Nr. ord. Reg. Com.:</span>
                                <span t-field="res_company.partner_id.nrc"/><br/>
                                <span>C.U.I. :</span>
                                <span t-field="res_company.partner_id.vat"/><br/>
                                <span>Sediul:</span>
                                <span t-field="res_company.city"/><br/>
                                <span/>
                                <span t-field="res_company.street"/><br/>
                                <span>Judetul:</span>
                                <span t-field="res_company.state_id"/><br/>
                                <span>Banca:</span>
                                <span>RAIFFEISEN BANK ROMANIA</span><br/>
                                <div t-foreach="res_company.bank_ids" t-as="bank">
                                    <span t-if="bank.currency_id.name == 'RON' ">
                                        RON: <span t-field="bank.acc_number"/>
                                    </span>
                                </div>
                                <div t-foreach="res_company.bank_ids" t-as="bank">
                                    <span t-if="bank.currency_id.name == 'EUR' ">
                                        EUR: <span t-field="bank.acc_number"/>
                                    </span>
                                </div>
                                <div t-if="res_company.share_capital">
    								<span>Capital Social </span>
									<t t-esc="'{0:,.2f}'.format(int(res_company.share_capital))"/> RON
								</div>
                                <span>Tel/Fax: </span>
                                <span t-field="res_company.phone"/> <span t-field="res_company.fax"/><br/>
								<div>
								    <span>Cota TVA: 0.00%</span>
								</div>
		
		 
		                        <small>
		                       	    <div t-foreach="res_company.partner_id.bank_ids" t-as="bank">
										<div t-if="bank.footer">
											<span t-if="bank.bank_name">
												<strong>Bank:</strong>
												<span t-field="bank.bank_name"/>
											</span>
											<span t-if="bank.acc_number">
												<strong>Account:</strong>
												<span t-field="bank.acc_number"/>
											</span>
		 
										</div>
		
									</div>
		                        </small>
	        				</td>
                            <td width="35%" style="vertical-align:bottom;text-align:center;">
                                <h4 class="text-center">
                                    <img t-if="company.logo" t-att-src="'data:image/png;base64,%s' % company.logo" style="max-height: 120px"/>
                                    <h3 style="font-weight:bold;">FACTURA FISCALA</h3>
                                    <br />
                                    Nr. facturii: 
                                    <t t-if="o.number">
                                    	<span t-field="o.number"/>
            	                    </t>
            	                    <t t-if="not o.number">
            	                    	<span t-field="o.internal_number"/>
            	                    </t> 
            	                    <br />
                                    Data: 
            	    				<span t-field="o.date_invoice"/>
            	    				<div t-if="o.type == 'out_refund'">  
            	    					<span>Refunding invoice</span>
            	    					<span t-field="o.origin"/>
            	    				</div>
                                    <br />
                                    1 EURO = <span t-esc="round(1/o.currency_id.rate_silent,4)" /> LEI
            	                </h4>
                            </td>
	       					<td width="30%">
                                <br />
                                <br />
                               <span>Seria/nr.: </span>
                               <t t-if="o.number">
                                        <span t-field="o.number"/>
        	                    </t>
        	                    <t t-if="not o.number">
        	                    	<span t-field="o.internal_number"/>
        	                    </t>
                                <div>
                                    Cumparator: <strong t-field="o.commercial_partner_id.name"/>
                                </div>
								<div>
									<span>Addresa:</span>
                                    <span t-field="o.commercial_partner_id.street"></span>
                                    <br />
                                    <span t-field="o.commercial_partner_id.country_id"></span>
								</div> 
		                        <small>
		                            <div t-foreach="o.commercial_partner_id.bank_ids" t-as="bank">
		    								<span t-if="bank.bank_name">
		    									<strong>Bank:</strong>
		    									<span t-field="bank.bank_name"/>
		    								</span>
		    								<span t-if="bank.acc_number">
		    									<strong>Account:</strong>
		    									<span t-field="bank.acc_number"/>
		    								</span>
		    						</div>
		                        </small>
                                <t t-if="o.commercial_partner_id.is_company">
    	                        <div t-if="o.commercial_partner_id.vat">
									<strong>IVA: </strong>
									<span t-field="o.commercial_partner_id.vat"/>
								</div>
								<div t-if="o.commercial_partner_id.nrc">
									<strong>NRC:</strong>
									<span t-field="o.commercial_partner_id.nrc"/>
								</div>    	
		                        </t>
	       					</td>
	   					</tr>
	    				<tr>
							<td style="border-top: initial;">
		                  	    		
	    					</td>
	    					<td style="border-top: initial;">
		                        
		                        <!-- 
		                         <t t-if="not o.commercial_partner_id.is_company">
		                         <div>
		    						<strong>CNP:</strong>
									<span t-field="o.commercial_partner_id.cnp"/>
								</div>
		                         </t>
		                         -->
	    					</td>
	    				</tr>
					</table>
	         		<div t-if="company.watermark_image" class="mb32 col-md-12">
	            		<img t-att-src="'data:image/png;base64,%s' % company.watermark_image" style="width:100%;text-align:center;position:absolute;opacity:0.05"/>
	    			</div>
				</div>
			</xpath>
			<!-- <t t-call="l10n_ro_invoice_report.header_invoice"/> -->
		</template>
		
		
		<!-- 
		<template id="report_invoice_document_body1"> 
			<xpath expr="//t[@t-call='report.external_layout']" position="replace">
				<div>
					DUDU
				</div>
			</xpath>
		</template>
		
		<template id="report_invoice_document_body2">
			<xpath expr="//t[@t-call='report.external_layout']" position="replace">
				<div>
					DUDU
				</div>
			</xpath> 
		</template>
		 -->

	<!-- 
		<template id="l10n_ro_report_invoice_document" inherit_id="l10n_ro_invoice_report.l10n_ro_report_invoice_document">
 
			
			<xpath expr="//span[@id='price_unit_without_taxes']" position="before">
 				<t t-set="price_unit_without_taxes" t-value="o.currency_id.with_context(date=o.date_invoice).compute(price_unit_without_taxes,currency_id)" />
			</xpath>
			<xpath expr="//span[@id='price_subtotal']" position="before">
 				<t t-set="price_subtotal" t-value="o.currency_id.with_context(date=o.date_invoice).compute(price_subtotal,currency_id)" />
			</xpath>
			<xpath expr="//span[@id='price_taxes']" position="before">
 				<t t-set="price_taxes" t-value="o.currency_id.with_context(date=o.date_invoice).compute(price_taxes,currency_id)" />
			</xpath>
			
			<xpath expr="//span[@id='amount_untaxeds']" position="before">
 				<t t-set="amount_untaxeds" t-value="o.currency_id.with_context(date=o.date_invoice).compute(amount_untaxeds,currency_id)" />
			</xpath>

			<xpath expr="//span[@id='amount_tax']" position="before">
 				<t t-set="amount_tax" t-value="o.currency_id.with_context(date=o.date_invoice).compute(amount_tax,currency_id)" />
			</xpath>


			<xpath expr="//span[@id='amount_tax']" position="before">
 				<t t-set="amount_tax" t-value="o.currency_id.with_context(date=o.date_invoice).compute(amount_tax,currency_id)" />
			</xpath>
			
		</template>
	
	 -->




	</data>
</openerp>